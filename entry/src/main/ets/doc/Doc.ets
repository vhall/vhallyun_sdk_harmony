import { promptAction, router } from '@kit.ArkUI';
import { VHDocument,VHDocumentView,VHDocumentViewModel,VHDocumentDrawType,VHDocumentWaterMark,VHDocumentDrawAction,VHDocFilType} from '@vhall/vhallyun-doc';
import StyleConstants from '../common/constants/StyleConstants';


@Entry
@Component
struct Doc {
  // è·å–ä¸Šä¸ªç•Œé¢ä¼ é€’è¿‡æ¥çš„æˆ¿é—´å·
  params: object = router.getParams() as object;
  public lss_id: string = this.params['lss_id'];
  public record_id: string = this.params['record_id'];
  public channel_id: string = this.params['channel_id'];
  public access_token: string = this.params['access_token'];

  //éœ€è¦ç”¨æˆ·æ ¹æ®ä¸šåŠ¡è‡ªå·±ç”ŸæˆdocID
  @State docId: string = '6312efc7';
 // @State docId: string = 'cf191346';
  // åŠ¨æ€æ›´æ–°tabä¸­çš„VHDocumentView
  @State documentViews: Array<VHDocument> = new Array();
  //å½“å‰æ–‡æ¡£é¡µ
  @State currentDocumentIndex: number = 0;
  @State tabTitle: string = '';
  @State startPaint: string = StyleConstants.START_PAINT;
  @State fontSize: number = 10;
  @State fontColor: string = '#ff0000';
  @State drawType: VHDocumentDrawType = VHDocumentDrawType.PATH;
  //æ°´å°å‚æ•°
  private waterMark: VHDocumentWaterMark = new VHDocumentWaterMark('hello world', 20);
  //æ°´å°é€æ˜åº¦
  private waterMarkOpacity: number = 1.0;
  //æ–‡æ¡£æ ‡æ¸…åˆ‡æ¢å®šæ—¶å™¨ã€‚
  private selectDocument: number = 0;
  //è¢«é€‰ä¸­æ–‡æ¡£çš„cidæ ‡è¯†
  @State selectCid: string = '';
  //æ˜¯å¦å¼€å¯æ¶‚é¸¦
  @State isDocPaint: boolean = false;
  //åˆå§‹åŒ–æ–‡æ¡£å¯¹è±¡ï¼Œè´Ÿè´£ç›‘å¬æ–‡æ¡£å›è°ƒ
  private document: VHDocument = new VHDocument(new VHDocumentViewModel(VHDocFilType.DOC));
  //å¦‚æœæ˜¯æ–‡æ¡£æ“ä½œæ–¹
  @State isDocController:boolean = false;
  //æ–‡æ¡£æ˜¯å¦æ˜¾ç¤ºå¯è§çŠ¶æ€
  @State showDoc:boolean = true;
  //æ–‡æ¡£æ¼”ç¤ºçŠ¶æ€ï¼Œå½“å‰æ–‡æ¡£è§‚çœ‹ç«¯æ˜¯å¦å¯è§
  @State docSwitchState:boolean = false;
  //
  private controller: TabsController = new TabsController()

  @Builder
  tabBuilder(model: VHDocument, targetIndex: number) {
    Column() {
      Text(model.documentViewModel.cid)
        .fontColor(Color.White)
        .margin({ top: 17, bottom: 7 })
    }.backgroundColor(this.currentDocumentIndex === targetIndex ? '#ff3ece16' : '#ffcbd9d9')
  }

  insertDocumentItem(doc: VHDocument) {
    this.documentViews.push(doc);
  }

  removeDocumentItem(cid: string) {
    for (let index = 0; index < this.documentViews.length; index++) {
      const element = this.documentViews[index];
      if (element.documentViewModel.cid == cid) {
        this.documentViews.splice(index, 1);
        element.deleteDoc();
      }
    }
  }

  getSelectDocumentByIndex(index: number): VHDocument | null {
    for (let i = 0; i < this.documentViews.length; i++) {
      if (index == i) {
        return this.documentViews[i];
      }
    }
    return null;
  }

  getSelectDocumentByCid(cid: string): VHDocument | null {
    for (let index = 0; index < this.documentViews.length; index++) {
      const element = this.documentViews[index].documentViewModel
      if (element?.cid == cid) {
        return this.documentViews[index];
      }
    }
    return null;
  }

  isExistDocument(cid: string): boolean {
    for (let index = 0; index < this.documentViews.length; index++) {
      const element = this.documentViews[index].documentViewModel
      if (element?.cid == cid) {
        return true;
      }
    }
    return false;
  }

  setTabSelectDocumentByCid(cid: string) {
    for (let index = 0; index < this.documentViews.length; index++) {
      const element = this.documentViews[index].documentViewModel
      if (element?.cid == cid) {
        this.controller.changeIndex(index);
      }
    }
  }

  @Builder
  documentViewBuilder() {
    Tabs({ barPosition: BarPosition.Start, controller: this.controller }) {
      //docæ–‡æ¡£æ¨¡å‹å¯¹è±¡éœ€è¦ä½œä¸ºå‚æ•°ä¼ å…¥VHDocumentViewç»„ä»¶å†…ã€‚
      ForEach(this.documentViews, (doc: VHDocument, index: number) => {
        TabContent() {
          //vhDocumentï¼š æ–‡æ¡£æ§åˆ¶æ¨¡å‹
          //isPaintï¼š æ§åˆ¶æ–‡æ¡£æ˜¯å¦å¯ä»¥è¿›è¡Œæ¶‚é¸¦æ“ä½œ
          //demonstrateProgress: æ˜¯å¦åŒæ­¥å†å²ç”»ç¬”æ•°æ®
          VHDocumentView({vhDocInterface:this, vhDocument: doc, demonstrateProgress: doc.documentViewModel.getLastData, isPaint:this.isDocPaint})
            .width('100%')
            .height('100%')
            .onSizeChange((oldValue: SizeOptions, newValue: SizeOptions) => {
              //é‡ç½®æ–‡æ¡£è§†å›¾å¤§å°ã€‚
              doc.setDocumentViewSize(newValue.width as number, newValue.height as number);
            })
        }
        .tabBar(this.tabBuilder(doc, index))

      }, (doc: VHDocument, index: number) => {
        if (this.selectCid == doc.documentViewModel.cid) {
          clearInterval(this.selectDocument);
          //å¯åŠ¨å®šæ—¶å»¶è¿Ÿåˆ‡æ¢åˆ°å¯¹åº”æ ‡ç­¾ã€‚
          this.selectDocument = setInterval(() => {
            this.controller.changeIndex(index);
            clearInterval(this.selectDocument);
          }, 100);
        }
        return doc.documentViewModel.cid;
      })
    }
    //.barHeight(0)// å¯é€šè¿‡è®¾ç½®æ­¤å‚æ•°éšè—tab
    .scrollable(false)
    .width('100%')
    .height('36%')
    .opacity(this.showDoc == true ? 100 : 0)
    .animationDuration(0)
    .backgroundColor('#F1F3F5')
    .onChange((index: number) => {
      this.currentDocumentIndex = index;
      this.getSelectDocumentByIndex(this.currentDocumentIndex)?.selectDoc();
    })
  }

  @Builder
  documentPageBuilder() {
    Row({ space: StyleConstants.SPACE_SIZE }) {
      Button('ä¸Šä¸€é¡µ').onClick(() => {
        this.getSelectDocumentByIndex(this.currentDocumentIndex)?.prevPage();
      })
        .fontSize(StyleConstants.BUTTON_FONT_SIZE)
        .padding({ left: 2, right: 2 })

      Button('ä¸‹ä¸€é¡µ').onClick(() => {
        this.getSelectDocumentByIndex(this.currentDocumentIndex)?.nextPage();
      })
        .fontSize(StyleConstants.BUTTON_FONT_SIZE)
        .padding({ left: 2, right: 2 })

      Text('æ¼”ç¤º')
      Toggle({ type: ToggleType.Switch, isOn: this.docSwitchState })
        .onChange((isOn: boolean) => {
          for (let i = 0; i < this.documentViews.length; i++) {
            this.documentViews[i].switchStatusDoc(isOn);
          }
          this.docSwitchState = isOn;
        })
    }
    .width(StyleConstants.FULL_WIDTH)
    .alignItems(VerticalAlign.Center)
    .align(Alignment.Start)
    .justifyContent(FlexAlign.Start)

    Divider()
      .vertical(false)
      .height(2)
      .color('#ff2f3235')
      .opacity(0.6)
      .margin({ top: 4, bottom: 4 })
  }

  @Builder
  brushShapeBuilder() {
    Row({ space: StyleConstants.SPACE_SIZE }) {
      Text('ç”»ç¬”å½¢çŠ¶')
      //è§å…‰ç¬”
      Button('ğŸ–').onClick(() => {
        this.drawType = VHDocumentDrawType.HIGHLIGHTER_PEN;
        for (let i = 0; i < this.documentViews.length; i++) {
          this.documentViews[i].setDrawType(this.drawType);
          this.documentViews[i].setDrawTypeOption(this.fontColor, this.fontSize);
        }
      }).padding({ left: 2, right: 2 })
      Button('ğŸ–Œ').onClick(() => {
        this.drawType = VHDocumentDrawType.PATH;
        for (let i = 0; i < this.documentViews.length; i++) {
          this.documentViews[i].setDrawType(this.drawType);
          this.documentViews[i].setDrawTypeOption(this.fontColor, this.fontSize);
        }
      }).padding({ left: 2, right: 2 })
      Button('â–¡').onClick(() => {
        this.drawType = VHDocumentDrawType.RECT;
        for (let i = 0; i < this.documentViews.length; i++) {
          this.documentViews[i].setDrawType(this.drawType);
          this.documentViews[i].setDrawTypeOption(this.fontColor, this.fontSize);
        }
      }).padding({ left: 2, right: 2 })
      Button('â—‹').onClick(() => {
        this.drawType = VHDocumentDrawType.CIRCLE;
        for (let i = 0; i < this.documentViews.length; i++) {
          this.documentViews[i].setDrawType(this.drawType);
          this.documentViews[i].setDrawTypeOption(this.fontColor, this.fontSize);
        }
      }).padding({ left: 2, right: 2 })
      Button('â–³').onClick(() => {
        this.drawType = VHDocumentDrawType.ISOSCELES_TRIANGLE;
        for (let i = 0; i < this.documentViews.length; i++) {
          this.documentViews[i].setDrawType(this.drawType);
          this.documentViews[i].setDrawTypeOption(this.fontColor, this.fontSize);
        }
      }).padding({ left: 2, right: 2 })
      Button('âŠ¿').onClick(() => {
        this.drawType = VHDocumentDrawType.RIGHT_TRIANGLE;
        for (let i = 0; i < this.documentViews.length; i++) {
          this.documentViews[i].setDrawType(this.drawType);
          this.documentViews[i].setDrawTypeOption(this.fontColor, this.fontSize);
        }
      }).padding({ left: 2, right: 2 })
      Button('â†’').onClick(() => {
        this.drawType = VHDocumentDrawType.SINGLE_ARROW;
        for (let i = 0; i < this.documentViews.length; i++) {
          this.documentViews[i].setDrawType(this.drawType);
          this.documentViews[i].setDrawTypeOption(this.fontColor, this.fontSize);
        }
      }).padding({ left: 2, right: 2 })
      Button('â†”').onClick(() => {
        this.drawType = VHDocumentDrawType.DOUBLE_ARROW;
        for (let i = 0; i < this.documentViews.length; i++) {
          this.documentViews[i].setDrawType(this.drawType);
          this.documentViews[i].setDrawTypeOption(this.fontColor, this.fontSize);
        }
      }).padding({ left: 2, right: 2 })
    }
    .width(StyleConstants.FULL_WIDTH)
    .alignItems(VerticalAlign.Center)
    .align(Alignment.Start)
    .justifyContent(FlexAlign.Start)
    .height(32)
  }

  @Builder
  brushColorBuilder() {
    Row({ space: StyleConstants.SPACE_SIZE }) {
      Text('ç”»ç¬”é¢œè‰²')
      Button('çº¢').onClick(() => {
        this.fontColor = '#ff0000';
        for (let i = 0; i < this.documentViews.length; i++) {
          this.documentViews[i].setDrawTypeOption(this.fontColor, this.fontSize);
        }
      }).padding({ left: 2, right: 2 })
      Button('æ©™').onClick(() => {
        this.fontColor = '#FFA500';
        for (let i = 0; i < this.documentViews.length; i++) {
          this.documentViews[i].setDrawTypeOption(this.fontColor, this.fontSize);
        }
      }).padding({ left: 2, right: 2 })
      Button('é»„').onClick(() => {
        this.fontColor = '#FFFF00';
        for (let i = 0; i < this.documentViews.length; i++) {
          this.documentViews[i].setDrawTypeOption(this.fontColor, this.fontSize);
        }
      }).padding({ left: 2, right: 2 })
      Button('ç»¿').onClick(() => {
        this.fontColor = '#00ff00';
        for (let i = 0; i < this.documentViews.length; i++) {
          this.documentViews[i].setDrawTypeOption(this.fontColor, this.fontSize);
        }
      }).padding({ left: 2, right: 2 })
      Button('è“').onClick(() => {
        this.fontColor = '#0000ff';
        for (let i = 0; i < this.documentViews.length; i++) {
          this.documentViews[i].setDrawTypeOption(this.fontColor, this.fontSize);
        }
      }).padding({ left: 2, right: 2 })
      Button('ç²‰').onClick(() => {
        this.fontColor = '#FFC0CB';
        for (let i = 0; i < this.documentViews.length; i++) {
          this.documentViews[i].setDrawTypeOption(this.fontColor, this.fontSize);
        }
      }).padding({ left: 2, right: 2 })
      Button('é»‘').onClick(() => {
        this.fontColor = '#000000';
        for (let i = 0; i < this.documentViews.length; i++) {
          this.documentViews[i].setDrawTypeOption(this.fontColor, this.fontSize);
        }
      }).padding({ left: 2, right: 2 })
    }
    .width(StyleConstants.FULL_WIDTH)
    .alignItems(VerticalAlign.Center)
    .align(Alignment.Start)
    .justifyContent(FlexAlign.Start)
    .height(32)
  }

  @Builder
  brushSizeBuilder() {
    Row({ space: StyleConstants.SPACE_SIZE }) {
      Text('çº¿å­—å¤§å°').width('20%')
      Text(this.fontSize.toString()).width('10%')
      Slider({
        min: 0,
        max: 100,
        step: 1,
        value: this.fontSize
      })
        .onChange((value: number, mode: SliderChangeMode) => {
          this.fontSize = Math.ceil(value);
          for (let i = 0; i < this.documentViews.length; i++) {
            this.documentViews[i].setDrawType(this.drawType);
            this.documentViews[i].setDrawTypeOption(this.fontColor, this.fontSize);
          }
        }).width('70%')
    }
    .width(StyleConstants.FULL_WIDTH)
    .alignItems(VerticalAlign.Center)
    .align(Alignment.Start)
    .justifyContent(FlexAlign.SpaceBetween)
  }

  @Builder
  waterMarkBuilder() {
    Row({ space: StyleConstants.SPACE_SIZE }) {
      Column({ space: StyleConstants.SPACE_SIZE }) {
        Text('æ°´å°è®¾ç½®')
        Toggle({ type: ToggleType.Switch, isOn: false })
          .onChange((isOn: boolean) => {
            if (isOn) {
              this.waterMark.opacity = this.waterMarkOpacity;
              for (let i = 0; i < this.documentViews.length; i++) {
                this.documentViews[i].setWaterMark(this.waterMark);
              }
            } else {
              this.waterMark.opacity = 0.0;
              for (let i = 0; i < this.documentViews.length; i++) {
                this.documentViews[i].setWaterMark(this.waterMark);
              }
            }
          })
      }.width('20%')

      Column({ space: StyleConstants.SPACE_SIZE }) {
        Row({ space: 2 }) {
          Text('æ°´å°å†…å®¹ï¼š')
          TextInput({ placeholder: 'hello world', text: 'hello world' })
            .onChange((value: string) => {
              this.waterMark.text = value;
            }).width('60%')
        }
        .justifyContent(FlexAlign.SpaceAround)

        Row({ space: 2 }) {
          Text('æ°´å°é¢œè‰²ï¼š')
          TextInput({ placeholder: '0x000000', text: '#000000' })
            .onChange((value: string) => {
              this.waterMark.color = value;
            }).width('60%')
        }
        .justifyContent(FlexAlign.SpaceAround)

        Row({ space: 2 }) {
          Text('æ—‹è½¬è§’åº¦ï¼š')
          TextInput({ placeholder: '0', text: '0' })
            .onChange((value: string) => {
              this.waterMark.angle = Number(value);
            }).width('60%')
        }
        .justifyContent(FlexAlign.SpaceAround)

        Row({ space: 2 }) {
          Text('å­—ä½“å¤§å°ï¼š')
          TextInput({ placeholder: '10', text: '10' })
            .onChange((value: string) => {
              this.waterMark.fontSize = Number(value);
            }).width('60%')
        }
        .justifyContent(FlexAlign.SpaceAround)

        Row({ space: StyleConstants.SPACE_SIZE }) {
          Text('ä¸é€æ˜åº¦ï¼š')
          TextInput({ placeholder: '1.0', text: '1.0' })
            .onChange((value: string) => {
              this.waterMark.opacity = Number(value);
              this.waterMarkOpacity = Number(value);
            }).width('60%')
        }
        .justifyContent(FlexAlign.SpaceAround)
      }
      .width('80%')
      .justifyContent(FlexAlign.Start)
    }
    .width(StyleConstants.FULL_WIDTH)
    .alignItems(VerticalAlign.Center)
    .align(Alignment.Start)
    .justifyContent(FlexAlign.SpaceEvenly)
  }

  @Builder documentPaintBuilder(){
    Row({space:StyleConstants.SPACE_SIZE}){
      Text('ç”»ç¬”æ¶‚é¸¦')
        .fontSize(StyleConstants.BUTTON_FONT_SIZE)

      Toggle({ type: ToggleType.Switch, isOn: this.isDocPaint})
        .onChange((isOn: boolean) => {
          this.isDocPaint = isOn;
        })

      Divider().vertical(true).height(22).color('#ff2f3235').opacity(0.6).margin({ left: 8, right: 8 })

      Button('æ’¤é”€').onClick(() => {
        const doc: VHDocument = this.getSelectDocumentByIndex(this.currentDocumentIndex) as VHDocument;
        if (doc.documentViewModel.isBoard) {
          doc.undo()
        } else {
          doc.preStep()
        }
      }).fontSize(StyleConstants.BUTTON_FONT_SIZE)
        .padding({ left: 2, right: 2 })

      Button('æ¢å¤').onClick(() => {
        const doc: VHDocument = this.getSelectDocumentByIndex(this.currentDocumentIndex) as VHDocument;
        if (doc.documentViewModel.isBoard) {
          doc.redo()
        } else {
          doc.nextStep()
        }
      }).fontSize(StyleConstants.BUTTON_FONT_SIZE)
        .padding({ left: 2, right: 2 });

      Divider()
        .vertical(true)
        .height(22)
        .color('#ff2f3235')
        .opacity(0.6)
        .margin({ left: 10, right: 10 })

      Button('ç§»åŠ¨').onClick(() => {
        this.getSelectDocumentByIndex(this.currentDocumentIndex)?.setDrawAction(VHDocumentDrawAction.MODIFY);
      })
        .fontSize(StyleConstants.BUTTON_FONT_SIZE)
        .padding({ left: 2, right: 2 })

      Button('æ©¡çš®æ“¦').onClick(() => {
        this.getSelectDocumentByIndex(this.currentDocumentIndex)?.setDrawAction(VHDocumentDrawAction.DELETE);
      })
        .fontSize(StyleConstants.BUTTON_FONT_SIZE)
        .padding({ left: 2, right: 2 })

      Button('æ¸…é™¤').onClick(() => {
        this.getSelectDocumentByIndex(this.currentDocumentIndex)?.clear();
      })
        .fontSize(StyleConstants.BUTTON_FONT_SIZE)
        .padding({ left: 2, right: 2 })
        .backgroundColor(Color.Red)
    }
    .width(StyleConstants.FULL_WIDTH)
    .alignItems(VerticalAlign.Center)
    .align(Alignment.Start)
    .justifyContent(FlexAlign.Start)
  }

  @Builder
  documentButtonBuilder() {
    Row({ space: StyleConstants.SPACE_SIZE }) {
      if(this.isDocController){
        TextInput({ placeholder: 'æ–‡æ¡£id', text: this.docId })
          .onChange((value: string) => {
            this.docId = value;
          }).width('30%')

        Button('+æ–‡æ¡£').onClick(() => {
          if (this.docId.length <= 0) {
            promptAction.showToast({
              duration: 2000,
              message: 'è¯·è¾“å…¥æ–‡æ¡£id'
            });
            return;
          }
          let mode = new VHDocumentViewModel(VHDocFilType.DOC);
          mode.docId = this.docId;
          mode.editEnable = this.isDocController;
          mode.docWidth = 720;
          mode.docHeight = 360;
          mode.backgroundColor = '#777777';
          let document: VHDocument = new VHDocument();
          document.setVHDocInterface(this);
          //æ–‡æ¡£æ¼”ç¤ºå‘èµ·ç«¯ä¸»åŠ¨åˆ›å»ºéœ€è¦è°ƒç”¨æ­¤æ¥å£ã€‚
          document.initDemonstration(mode, this.access_token, this.lss_id, this.channel_id);
          this.insertDocumentItem(document);
          this.selectCid = mode.cid;
        })
          .fontSize(StyleConstants.BUTTON_FONT_SIZE)
          .padding({ left: 2, right: 2 });

        Button('+ç™½æ¿').onClick(() => {
          const mode = new VHDocumentViewModel(VHDocFilType.BOARD);
          mode.docId = this.docId;
          mode.editEnable = this.isDocController;
          mode.docWidth = 720;
          mode.docHeight = 360;
          mode.backgroundColor = '#ffffff';
          const document: VHDocument = new VHDocument();
          document.setVHDocInterface(this);
          this.insertDocumentItem(document);
          document.initDemonstration(mode, this.access_token, this.lss_id, this.channel_id);
          this.selectCid = mode.cid;
        })
          .fontSize(StyleConstants.BUTTON_FONT_SIZE)
          .padding({ left: 2, right: 2 });

        Button('ç§»é™¤').onClick(() => {
          const document: VHDocument = this.documentViews[this.currentDocumentIndex];
          if(document){
            document.deleteDoc();
          }
          this.documentViews.splice(this.currentDocumentIndex, 1);
        })
          .fontSize(StyleConstants.BUTTON_FONT_SIZE)
          .padding({ left: 2, right: 2 });

        Divider()
          .vertical(true)
          .height(22)
          .color('#ff2f3235')
          .opacity(0.6)
          .margin({ left: 8, right: 8 })
      }

      Text('è®¾ä¸ºæ¼”ç¤ºç«¯')
      .fontSize(StyleConstants.BUTTON_FONT_SIZE)
      Toggle({ type: ToggleType.Switch, isOn: this.isDocController})
      .onChange((isOn: boolean) => {
        for (let i = 0; i < this.documentViews.length; i++) {
          this.documentViews[i].setEditable(isOn);
        }
        this.isDocController = isOn;
        if(isOn){
          //è¢«è®¾ç½®ä¸ºæ¼”ç¤ºç«¯æ—¶æ–‡æ¡£å¯è§ä¸”å…è®¸æ¶‚é¸¦
          this.isDocPaint = isOn;
          this.showDoc = isOn;
        }
      })
    }
    .width(StyleConstants.FULL_WIDTH)
    .alignItems(VerticalAlign.Center)
    .align(Alignment.Start)
    .justifyContent(FlexAlign.Start)
  }

  build() {
    Column() {
      this.documentViewBuilder();
      this.documentButtonBuilder();
      if(this.isDocController){
        Column() {
          this.documentPageBuilder();
          this.documentPaintBuilder();
          this.brushShapeBuilder();
          this.brushColorBuilder();
          this.brushSizeBuilder();
          this.waterMarkBuilder();
        }
        .justifyContent(FlexAlign.Start)
        .alignItems(HorizontalAlign.Start)
        .align(Alignment.TopStart)
      }
    }
    .height('100%')
    .width('100%')

  };

  aboutToAppear(): void {
    // æ‰“å°ç‰ˆæœ¬å·
    console.log('Docç‰ˆæœ¬å·' + VHDocument.getSDKVersion());
    this.document.setVHDocInterface(this);
    //åˆå§‹åŒ–ç›´æ’­æ–‡æ¡£ï¼Œç›‘å¬æ–‡æ¡£æ¶ˆæ¯ã€‚
    this.document.initLiveDoc(this.lss_id, this.channel_id, this.access_token, true)
  }

  aboutToDisappear(): void {
    //é‡Šæ”¾æ–‡æ¡£æ¶ˆæ¯ç›‘å¬ã€‚
    this.document.destroyDoc();
  }

  /**
   * æ–‡æ¡£åˆå§‹åŒ–ã€åˆ›å»ºå¤±è´¥å›è°ƒ
   * @param errorCode é”™è¯¯ç 
   * @param errorMsg  é”™è¯¯ä¿¡æ¯
   * @param cid æ–‡æ¡£ç™½æ¿æ ‡è¯†ã€‚
   */
  docError(errorCode: number, errorMsg: string, cid?: string): void {
    promptAction.showToast({
      duration: 2000,
      message: errorMsg
    });
    if (cid) {
      //å½“åˆ›å»ºæ–‡æ¡£å¤±è´¥æ—¶ï¼Œåˆ é™¤æ–‡æ¡£ã€‚
      if (this.isExistDocument(cid)) {
        this.removeDocumentItem(cid);
      }
    }
  }

  /**  ç›´æ’­æ–‡æ¡£åŒæ­¥
   *
   * @param channelID æ–‡æ¡£channelID
   * @return number å»¶è¿Ÿæ‰§è¡Œæ—¶é—´(ç§’)
   */
  dolayChannelID(channelID: string): number {
    return 0.0;
  }

  /**
   * æ˜¯å¦æ˜¾ç¤ºæ–‡æ¡£
   * @param switchStatus : true æ–‡æ¡£å¯è§çŠ¶æ€ã€‚falseï¼šæ–‡æ¡£ä¸å¯è§çŠ¶æ€
   */
  docSwitchStatus(switchStatus: boolean): void {
    //å¦‚æœä¸æ˜¯æ¼”ç¤ºç«¯ï¼Œåˆ™æ”¶åˆ°æ˜¯å¦æ˜¾ç¤ºæ–‡æ¡£æ—¶è¿›è¡Œéšè—æˆ–æ˜¾ç¤ºå¤„ç†ï¼ŒåŒæ—¶ä¸å…è®¸è¿›è¡Œæ¶‚é¸¦ã€‚æ˜¯å¦ä¸ºæ¼”ç¤ºç«¯éœ€è¦ä¸šåŠ¡ä¾§è‡ªè¡Œå¤„ç†ã€‚
    if(!this.isDocController){
      this.isDocPaint = false;
      this.showDoc = switchStatus;
    }
    this.docSwitchState = switchStatus;
  }

  /**
   * ç¿»é¡µæ¶ˆæ¯
   * @param documentView   æ–‡æ¡£id ä¸ºç©ºæ—¶æ²¡æœ‰ æ–‡æ¡£
   */
  docChangePage(docViewModel: VHDocumentViewModel): void {

  }

  /**
   * é€‰æ‹©æ–‡æ¡£
   * @param documentView æ–‡æ¡£è§†å›¾
   */
  docSelect(cid: string): void {
    this.setTabSelectDocumentByCid(cid);
    this.selectCid = cid;
  }

  /**
   * æ·»åŠ æ–‡æ¡£
   * @param documentView æ–‡æ¡£è§†å›¾
   */
  docAdd(docViewModel: VHDocumentViewModel): void {
    for (let index = 0; index < this.documentViews.length; index++) {
      const element = this.documentViews[index].documentViewModel
      if (element?.cid == docViewModel.cid) {
        this.documentViews[index].documentViewModel = docViewModel;
        return;
      }
    }
    let document: VHDocument = new VHDocument(docViewModel);
    document.setEditable(this.isDocController);
    //æ–‡æ¡£æ¼”ç¤ºå‘èµ·ç«¯,å¦‚æœç›‘å¬åˆ°åˆ›å»ºæ–°æ–‡æ¡£ï¼Œéœ€è¦è°ƒç”¨æ­¤æ¥å£
    document.initDemonstrationFromMsg(this.access_token, this.lss_id, this.channel_id);
    this.insertDocumentItem(document);
  }

  /**
   * åˆ é™¤æ–‡æ¡£
   * @param documentView æ–‡æ¡£è§†å›¾
   */
  docRemove(cid: string): void {
    this.removeDocumentItem(cid);
  }
}